{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import\"../user-pages.css\";import api,{getServiceDetails}from\"../../api/client\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ServiceDetail(_ref){let{service,onBack,onAddToPlan}=_ref;const[availability,setAvailability]=useState([]);const[loadingAvail,setLoadingAvail]=useState(true);const[errorAvail,setErrorAvail]=useState(\"\");// üîπ derive backend base URL from axios baseURL (http://localhost:5000/api ‚Üí http://localhost:5000)\nconst apiBase=api.defaults.baseURL||\"\";const backendBase=apiBase.replace(/\\/api\\/?$/,\"\");useEffect(()=>{if(!service)return;setLoadingAvail(true);getServiceDetails(service.id).then(data=>{if(!data.ok)throw new Error(\"Failed to load\");setAvailability(data.availability||[]);setErrorAvail(\"\");}).catch(err=>{console.error(err);setErrorAvail(\"Could not load availability\");}).finally(()=>setLoadingAvail(false));},[service]);if(!service){return/*#__PURE__*/_jsxs(\"div\",{className:\"user-section\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onBack,className:\"user-back\",children:\"\\u2190 Back to Services\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No service selected.\"})]});}const openDates=availability.filter(d=>!d.is_booked);const hasAvailability=openDates.length>0;let availabilityText=\"Unavailable\";if(loadingAvail){availabilityText=\"Checking...\";}else if(errorAvail){availabilityText=\"Unavailable\";}else if(availability.length===0){availabilityText=\"Unavailable\";}else if(hasAvailability){availabilityText=openDates.map(d=>new Date(d.available_date).toLocaleDateString()).join(\", \");}else{availabilityText=\"Fully booked\";}const canAddToPlan=true;const badgeClass=hasAvailability&&!loadingAvail&&!errorAvail?\"user-badge-success\":\"user-badge-danger\";// üîπ first photo from listServices() result\nconst firstPhoto=service.photos&&service.photos.length>0?service.photos[0]:null;// üîπ build full URL to backend: http://localhost:5000/uploads/services/xxx.jpg\nconst firstPhotoUrl=firstPhoto&&firstPhoto.startsWith(\"http\")?firstPhoto:firstPhoto?\"\".concat(backendBase).concat(firstPhoto):null;return/*#__PURE__*/_jsxs(\"div\",{className:\"user-section\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onBack,className:\"user-back\",children:\"\\u2190 Back to Services\"}),/*#__PURE__*/_jsx(\"div\",{className:\"user-card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-grid user-grid-2\",style:{alignItems:\"flex-start\"},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"user-title\",style:{marginTop:0},children:service.name}),/*#__PURE__*/_jsx(\"p\",{className:\"user-subtitle\",style:{marginBottom:\"1.5rem\"},children:service.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-grid user-grid-3\",style:{marginBottom:\"1.5rem\"},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-label\",children:\"Price\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-card-price\",style:{fontSize:\"1.5rem\"},children:[\"$\",service.price]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-label\",children:\"Availability\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"user-badge \".concat(badgeClass),children:availabilityText})})]}),service.capacity?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-label\",children:\"Capacity\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,fontSize:\"1.1rem\"},children:[service.capacity,\" guests\"]})]}):null]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>onAddToPlan(service),disabled:!canAddToPlan,className:\"user-btn \".concat(canAddToPlan?\"user-btn-success\":\"\"),style:{opacity:canAddToPlan?1:0.5,cursor:canAddToPlan?\"pointer\":\"not-allowed\"},children:\"Add to Plan\"})})]}),/*#__PURE__*/_jsx(\"div\",{children:firstPhotoUrl&&/*#__PURE__*/_jsx(\"img\",{src:firstPhotoUrl,alt:service.name,style:{width:\"100%\",maxWidth:\"400px\",height:\"240px\",objectFit:\"cover\",borderRadius:\"16px\"}})})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","api","getServiceDetails","jsx","_jsx","jsxs","_jsxs","ServiceDetail","_ref","service","onBack","onAddToPlan","availability","setAvailability","loadingAvail","setLoadingAvail","errorAvail","setErrorAvail","apiBase","defaults","baseURL","backendBase","replace","id","then","data","ok","Error","catch","err","console","error","finally","className","children","onClick","openDates","filter","d","is_booked","hasAvailability","length","availabilityText","map","Date","available_date","toLocaleDateString","join","canAddToPlan","badgeClass","firstPhoto","photos","firstPhotoUrl","startsWith","concat","style","alignItems","marginTop","name","marginBottom","description","fontSize","price","capacity","fontWeight","disabled","opacity","cursor","src","alt","width","maxWidth","height","objectFit","borderRadius"],"sources":["C:/Users/Lenovo/Desktop/ll/Wedding-Planner-App/frontend/src/User/ManageServices/ServiceDetail.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"../user-pages.css\";\r\nimport api, { getServiceDetails } from \"../../api/client\";\r\n\r\nexport default function ServiceDetail({ service, onBack, onAddToPlan }) {\r\n  const [availability, setAvailability] = useState([]);\r\n  const [loadingAvail, setLoadingAvail] = useState(true);\r\n  const [errorAvail, setErrorAvail] = useState(\"\");\r\n\r\n  // üîπ derive backend base URL from axios baseURL (http://localhost:5000/api ‚Üí http://localhost:5000)\r\n  const apiBase = api.defaults.baseURL || \"\";\r\n  const backendBase = apiBase.replace(/\\/api\\/?$/, \"\");\r\n\r\n  useEffect(() => {\r\n    if (!service) return;\r\n\r\n    setLoadingAvail(true);\r\n\r\n    getServiceDetails(service.id)\r\n      .then((data) => {\r\n        if (!data.ok) throw new Error(\"Failed to load\");\r\n        setAvailability(data.availability || []);\r\n        setErrorAvail(\"\");\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n        setErrorAvail(\"Could not load availability\");\r\n      })\r\n      .finally(() => setLoadingAvail(false));\r\n  }, [service]);\r\n\r\n  if (!service) {\r\n    return (\r\n      <div className=\"user-section\">\r\n        <button onClick={onBack} className=\"user-back\">\r\n          ‚Üê Back to Services\r\n        </button>\r\n        <p>No service selected.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const openDates = availability.filter((d) => !d.is_booked);\r\n  const hasAvailability = openDates.length > 0;\r\n\r\n  let availabilityText = \"Unavailable\";\r\n\r\n  if (loadingAvail) {\r\n    availabilityText = \"Checking...\";\r\n  } else if (errorAvail) {\r\n    availabilityText = \"Unavailable\";\r\n  } else if (availability.length === 0) {\r\n    availabilityText = \"Unavailable\";\r\n  } else if (hasAvailability) {\r\n    availabilityText = openDates\r\n      .map((d) => new Date(d.available_date).toLocaleDateString())\r\n      .join(\", \");\r\n  } else {\r\n    availabilityText = \"Fully booked\";\r\n  }\r\n\r\n  const canAddToPlan = true;\r\n\r\n  const badgeClass =\r\n    hasAvailability && !loadingAvail && !errorAvail\r\n      ? \"user-badge-success\"\r\n      : \"user-badge-danger\";\r\n\r\n  // üîπ first photo from listServices() result\r\n  const firstPhoto =\r\n    service.photos && service.photos.length > 0 ? service.photos[0] : null;\r\n\r\n  // üîπ build full URL to backend: http://localhost:5000/uploads/services/xxx.jpg\r\n  const firstPhotoUrl =\r\n    firstPhoto && firstPhoto.startsWith(\"http\")\r\n      ? firstPhoto\r\n      : firstPhoto\r\n      ? `${backendBase}${firstPhoto}`\r\n      : null;\r\n\r\n  return (\r\n    <div className=\"user-section\">\r\n      <button onClick={onBack} className=\"user-back\">\r\n        ‚Üê Back to Services\r\n      </button>\r\n\r\n      <div className=\"user-card\">\r\n        <div\r\n          className=\"user-grid user-grid-2\"\r\n          style={{ alignItems: \"flex-start\" }}\r\n        >\r\n          {/* LEFT: text, availability, button */}\r\n          <div>\r\n            <h2 className=\"user-title\" style={{ marginTop: 0 }}>\r\n              {service.name}\r\n            </h2>\r\n\r\n            <p className=\"user-subtitle\" style={{ marginBottom: \"1.5rem\" }}>\r\n              {service.description}\r\n            </p>\r\n\r\n            <div\r\n              className=\"user-grid user-grid-3\"\r\n              style={{ marginBottom: \"1.5rem\" }}\r\n            >\r\n              <div>\r\n                <div className=\"user-label\">Price</div>\r\n                <div\r\n                  className=\"user-card-price\"\r\n                  style={{ fontSize: \"1.5rem\" }}\r\n                >\r\n                  ${service.price}\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <div className=\"user-label\">Availability</div>\r\n                <div>\r\n                  <span className={`user-badge ${badgeClass}`}>\r\n                    {availabilityText}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              {service.capacity ? (\r\n                <div>\r\n                  <div className=\"user-label\">Capacity</div>\r\n                  <div\r\n                    style={{ fontWeight: 600, fontSize: \"1.1rem\" }}\r\n                  >\r\n                    {service.capacity} guests\r\n                  </div>\r\n                </div>\r\n              ) : null}\r\n            </div>\r\n\r\n            <div>\r\n              <button\r\n                onClick={() => onAddToPlan(service)}\r\n                disabled={!canAddToPlan}\r\n                className={`user-btn ${\r\n                  canAddToPlan ? \"user-btn-success\" : \"\"\r\n                }`}\r\n                style={{\r\n                  opacity: canAddToPlan ? 1 : 0.5,\r\n                  cursor: canAddToPlan ? \"pointer\" : \"not-allowed\",\r\n                }}\r\n              >\r\n                Add to Plan\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* RIGHT: photo */}\r\n          <div>\r\n            {firstPhotoUrl && (\r\n              <img\r\n                src={firstPhotoUrl}\r\n                alt={service.name}\r\n                style={{\r\n                  width: \"100%\",\r\n                  maxWidth: \"400px\",\r\n                  height: \"240px\",\r\n                  objectFit: \"cover\",\r\n                  borderRadius: \"16px\",\r\n                }}\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}